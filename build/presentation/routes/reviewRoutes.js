"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var express_1 = __importDefault(require("express"));
var reviewRouter = express_1.default.Router();
var ReviewRepository_1 = __importDefault(require("../../infrastructure/repositories/ReviewRepository"));
var CreateReviewUseCase_1 = __importDefault(require("../../core/use-cases/review-usecases/CreateReviewUseCase"));
var UpdateReviewUseCase_1 = __importDefault(require("../../core/use-cases/review-usecases/UpdateReviewUseCase"));
var DeleteReviewUseCase_1 = __importDefault(require("../../core/use-cases/review-usecases/DeleteReviewUseCase"));
var GetCourseReviewsUseCase_1 = __importDefault(require("../../core/use-cases/review-usecases/GetCourseReviewsUseCase"));
var ReviewController_1 = __importDefault(require("../controllers/review-controllers/ReviewController"));
var authMiddleware_1 = require("../middleware/authMiddleware");
var UserRepository_1 = require("../../infrastructure/repositories/UserRepository");
var JwtService_1 = require("../../infrastructure/external-services/JwtService");
var GetUserDetailsUseCase_1 = require("../../core/use-cases/user-usecases/GetUserDetailsUseCase");
var enums_1 = require("../../core/entities/misc/enums");
var reviewRepository = new ReviewRepository_1.default();
var createReviewUseCase = new CreateReviewUseCase_1.default(reviewRepository);
var updateReviewUseCase = new UpdateReviewUseCase_1.default(reviewRepository);
var deleteReviewUseCase = new DeleteReviewUseCase_1.default(reviewRepository);
var getCourseReviewsUseCase = new GetCourseReviewsUseCase_1.default(reviewRepository);
var reviewController = new ReviewController_1.default(createReviewUseCase, updateReviewUseCase, deleteReviewUseCase, getCourseReviewsUseCase);
var userRepository = new UserRepository_1.UserRepository();
var jwtService = new JwtService_1.JwtService();
var getUserDetailsUseCase = new GetUserDetailsUseCase_1.GetUserDetailsUseCase(userRepository);
var authMiddleware = authMiddleware_1.AuthMiddleware.create(jwtService, getUserDetailsUseCase);
var authorize = authMiddleware_1.AuthMiddleware.authorize([enums_1.UserRole.USER]);
reviewRouter.post("/add", authMiddleware, authorize, reviewController.create);
reviewRouter.put("/update", authMiddleware, authorize, reviewController.update);
reviewRouter.delete("/:reviewId", authMiddleware, authorize, reviewController.delete);
reviewRouter.get("/:courseId", authMiddleware, authorize, reviewController.getCourseReviews);
exports.default = reviewRouter;
