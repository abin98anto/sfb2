"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var express_1 = __importDefault(require("express"));
var subscriptionRoutes = express_1.default.Router();
var SubscriptionRepository_1 = __importDefault(require("../../infrastructure/repositories/SubscriptionRepository"));
var GetAllSubscriptionsUseCase_1 = __importDefault(require("../../core/use-cases/subscription-usecases/GetAllSubscriptionsUseCase"));
var CreateSubscriptionUseCase_1 = __importDefault(require("../../core/use-cases/subscription-usecases/CreateSubscriptionUseCase"));
var UpdateSubscriptionUseCase_1 = __importDefault(require("../../core/use-cases/subscription-usecases/UpdateSubscriptionUseCase"));
var SubscriptionController_1 = __importDefault(require("../controllers/admin-controllers/SubscriptionController"));
var HandleExpiredSubscriptionsUseCase_1 = __importDefault(require("../../core/use-cases/subscription-usecases/HandleExpiredSubscriptionsUseCase"));
var JwtService_1 = require("../../infrastructure/external-services/JwtService");
var UserRepository_1 = require("../../infrastructure/repositories/UserRepository");
var GetUserDetailsUseCase_1 = require("../../core/use-cases/user-usecases/GetUserDetailsUseCase");
var authMiddleware_1 = require("../middleware/authMiddleware");
var enums_1 = require("../../core/entities/misc/enums");
var subscriptionRepository = new SubscriptionRepository_1.default();
var getAllUseCase = new GetAllSubscriptionsUseCase_1.default(subscriptionRepository);
var createSubscriptionUseCase = new CreateSubscriptionUseCase_1.default(subscriptionRepository);
var updateSubscriptionUseCase = new UpdateSubscriptionUseCase_1.default(subscriptionRepository);
var handleExpiredSubscriptionsUseCase = new HandleExpiredSubscriptionsUseCase_1.default(subscriptionRepository);
var subscriptionController = new SubscriptionController_1.default(createSubscriptionUseCase, updateSubscriptionUseCase, getAllUseCase, handleExpiredSubscriptionsUseCase);
var jwtService = new JwtService_1.JwtService();
var userRepository = new UserRepository_1.UserRepository();
var getUserDetailsUseCase = new GetUserDetailsUseCase_1.GetUserDetailsUseCase(userRepository);
var authMiddleware = authMiddleware_1.AuthMiddleware.create(jwtService, getUserDetailsUseCase);
var authorize = authMiddleware_1.AuthMiddleware.authorize([enums_1.UserRole.ADMIN]);
subscriptionRoutes.get("/", subscriptionController.getAll);
subscriptionRoutes.post("/add", authMiddleware, authorize, subscriptionController.create);
subscriptionRoutes.put("/update", authMiddleware, authorize, subscriptionController.update);
exports.default = subscriptionRoutes;
